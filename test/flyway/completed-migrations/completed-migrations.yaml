apiVersion: v1
kind: ConfigMap
metadata:
  name: migration-configmap
  namespace: flyway
  annotations:
    argocd.argoproj.io/hook: PreSync
data:
  V1_3_4__annotation_status.sql: |
    create type annotation_status_enum as enum ('ACCEPTED', 'MERGED', 'PENDING', 'REJECTED', 'TOMBSTONED');
    alter table public.annotation add annotation_status annotation_status_enum;
    create index annotation_status_index on annotation(target_id, annotation_status);
  V1_3_1__add_temp_doi_table.sql: |
    create table manual_pid
    (
        pid      text,
        prefix   text
    );
    comment on table manual_pid is 'PIDs from which the PID manager may pull';
    comment on column manual_pid.pid is 'Persistent identifier';
    comment on column manual_pid.prefix is 'One of: TEST, SANDBOX, 20.5000.1025, 10.3535';
  V1_3__update_test_table_again.sql: |
    alter table migration_test.test_table
    add another_col_again text;
  V1_2__update_test_table.sql: |
    alter table migration_test.test_table
    add another_col text;
